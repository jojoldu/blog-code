# 2. Web API 디자인 - 구조편

 
## 잦은 요청과 불필요한 데이터 둘의 조절이 필요하다

모든 웹 요청은 많아지면 웹 서버의 부하를 높인다.    
따라서 다수의 작은 리소스를 표시하는 "번잡한" Web API를 피하도록 노력해야 한다.  
이러한 API는 클라이언트 애플리케이션이 필요한 모든 데이터를 찾기 위해 여러 요청을 보내야 할 수 있다.  

그 대신, 데이터를 비정규화하고 단일 요청을 통해 관련 정보를 검색할 수 있는 더 큰 리소스로 결합하는 것이 좋다.  

단, 이 접근 방식과 클라이언트에 필요 없는 데이터를 가져오는 오버헤드의 균형을 조정해야 한다.  

한번의 API 조회로 필요한 모든 데이터를 가져오게 되면 상황에 따라 그 한번의 요청이 레이턴시를 증가시킨다.  


## GET, PUT, DELETE, HEAD 및 PATCH 작업은 멱등해야 한다.

- 위 HTTP 메소드들은 모두 부수 효과가 없어야 한다. 
- 동일한 리소스에 대해 동일한 요청이 반복되면 그 결과는 동일한 상태여야한다. 
- 응답 메시지의 HTTP 상태 코드는 다를 수 있지만 여러 DELETE 요청을 동일한 URI로 보내는 것은 동일한 효과가 있어야 한다. 
  - 예를 들어 첫 번째 DELETE 요청은 상태 코드 204(콘텐츠 없음)를 반환하고, 그 이후 DELETE 요청은 상태 코드 404(찾을 수 없음)를 반환할 수 있다.
  - 단, 서버 혹은 데이터베이스 등에서는 첫번째나 그 이후의 요청에서 변경되는 부분이 없어야 한다.

## 새 리소스를 생성하는 POST 에는 연관 관계가 있는 리소스에만 영향을 줘야한다

- POST 요청이 새 리소스를 만들기 위한 것인 경우 요청의 효과는 새 리소스로 제한되어야 한다. 
  - 관련 링크의 종류가 있는 경우 직접 관련된 리소스일 수 있음 
- 예를 들어 전자 상거래 시스템에서 고객에게 새 주문을 만드는 POST 요청은 재고 수준을 수정하고 청구 정보를 생성할 수도 있지만 주문과 직접 관련되지 않은 정보를 수정하거나 시스템 전체 상태에 다른 부작용이 있으면 안된다.

## 번잡한 POST, PUT 및 DELETE 작업을 구현하지 않는다

- 리소스 컬렉션에 대한 POST, PUT 및 DELETE 요청을 지원한다. 
- POST 요청은 다수의 새로운 리소스에 대한 세부 정보를 포함할 수 있으며 그 모두를 동일한 컬렉션에 추가할 수 있고, PUT 요청은 컬렉션에 포함된 전체 리소스를 바꿀 수 있고, DELETE 요청은 컬렉션 전체를 제거할 수 있다.


## 상태 변화

- Get: 상태 변화를 주지 않는 기능
- Post: 상태 변화를 주는 기능

## 멱등성 지원하기

POST는 멱등하지 않다.  
PUT은 멱등하다.  
여러번 반복해도 동일한 결과를 보장한다.  
이를 활용하면 **리소스 생성에 대해 멱등성을 보장하는 것을 고려해볼 수 있다**.  

```bash
POST /reviews

PUT /reviews/1009
If-None-Match: *
```

- `If-None-Match: *`: URL에 기존 리소스가 없으면 제공된 URL에 새로운 리소스를 생성하라.

다만, PUT은 특성상 




